(function(){'use strict';AOS.init({duration: 800,once: true});const dateInput = document.getElementById('date_souhaitee');if(dateInput){dateInput.min = new Date().toISOString().split('T')[0];}document.querySelectorAll('.service-card').forEach(card =>{card.addEventListener('click',function(){document.querySelectorAll('.service-card').forEach(c => c.classList.remove('selected'));this.classList.add('selected');const serviceTypeInput = document.getElementById('service_type');if(serviceTypeInput){serviceTypeInput.value = this.dataset.service;}const serviceError = document.getElementById('serviceError');if(serviceError){serviceError.classList.remove('d-block');serviceError.classList.add('d-none');}});});let currentStep = 1;window.nextStep = function(step){if(validateStep(currentStep)){if(step === 3){fillConfirmation();}showStep(step);}};window.prevStep = function(step){showStep(step);};function showStep(step){document.querySelectorAll('.form-step').forEach(s => s.classList.remove('active'));document.querySelectorAll('.step-item').forEach(s =>{s.classList.remove('active');if(parseInt(s.dataset.step)< step){s.classList.add('completed');}else{s.classList.remove('completed');}});const stepElement = document.getElementById('step' + step);if(stepElement){stepElement.classList.add('active');}const stepIndicator = document.querySelector(`[data-step="${step}"]`);if(stepIndicator){stepIndicator.classList.add('active');}currentStep = step;}function validateStep(step){let isValid = true;if(step === 1){const nom = document.getElementById('nom');const telephone = document.getElementById('telephone');const email = document.getElementById('email');const adresse = document.getElementById('adresse_complete');const ville = document.getElementById('ville');const pays = document.getElementById('pays');if(!nom || !nom.value.trim()){if(nom)nom.classList.add('is-invalid');isValid = false;}else{nom.classList.remove('is-invalid');}if(!telephone || !telephone.value.trim()|| !validatePhone(telephone.value)){if(telephone)telephone.classList.add('is-invalid');isValid = false;}else{telephone.classList.remove('is-invalid');}if(!email || !email.value.trim()|| !validateEmail(email.value)){if(email)email.classList.add('is-invalid');isValid = false;}else{email.classList.remove('is-invalid');}if(!adresse || !adresse.value.trim()){if(adresse)adresse.classList.add('is-invalid');isValid = false;}else{adresse.classList.remove('is-invalid');}if(!ville || !ville.value.trim()){if(ville)ville.classList.add('is-invalid');isValid = false;}else{ville.classList.remove('is-invalid');}if(!pays || !pays.value.trim()){if(pays)pays.classList.add('is-invalid');isValid = false;}else{pays.classList.remove('is-invalid');}}else if(step === 2){const service = document.getElementById('service_type');const date = document.getElementById('date_souhaitee');const heure = document.getElementById('heure_souhaitee');const serviceError = document.getElementById('serviceError');if(!service || !service.value){if(serviceError){serviceError.classList.remove('d-none');serviceError.classList.add('d-block');}isValid = false;}else{if(serviceError){serviceError.classList.remove('d-block');serviceError.classList.add('d-none');}}if(!date || !date.value || !validateDate(date.value)){if(date)date.classList.add('is-invalid');isValid = false;}else{date.classList.remove('is-invalid');}if(!heure || !heure.value || !validateTime(heure.value)){if(heure)heure.classList.add('is-invalid');isValid = false;}else{heure.classList.remove('is-invalid');}}return isValid;}function fillConfirmation(){const serviceLabels ={'consultation_medicale': 'Consultation médicale','kinesitherapie': 'Kinésithérapie','readaptation': 'Réadaptation','psychologie': 'Psychologie clinique','orthopedie': 'Orthopédie et rééducation','ergotherapie': 'Ergothérapie','developpement_enfant': 'Développement de l\'enfant','therapies_groupe': 'Thérapies de groupe','personnes_agees': 'Accompagnement des personnes âgées','autre': 'Autre'};const genreLabels ={'homme': 'Homme','femme': 'Femme','autre': 'Autre','non_specifie': 'Non spécifié'};const nomEl = document.getElementById('nom');const telephoneEl = document.getElementById('telephone');const emailEl = document.getElementById('email');const dateNaissanceEl = document.getElementById('date_naissance');const genreEl = document.getElementById('genre');const nationaliteEl = document.getElementById('nationalite');const professionEl = document.getElementById('profession');const assuranceEl = document.getElementById('assurance_sante');const adresseEl = document.getElementById('adresse_complete');const codePostalEl = document.getElementById('code_postal');const villeEl = document.getElementById('ville');const paysEl = document.getElementById('pays');const serviceEl = document.getElementById('service_type');const dateEl = document.getElementById('date_souhaitee');const heureEl = document.getElementById('heure_souhaitee');const motifEl = document.getElementById('motif_consultation');const messageEl = document.getElementById('message');const confirmNom = document.getElementById('confirmNom');const confirmTelephone = document.getElementById('confirmTelephone');const confirmEmail = document.getElementById('confirmEmail');const confirmDateNaissance = document.getElementById('confirmDateNaissance');const confirmGenre = document.getElementById('confirmGenre');const confirmNationalite = document.getElementById('confirmNationalite');const confirmProfession = document.getElementById('confirmProfession');const confirmAssurance = document.getElementById('confirmAssurance');const confirmAdresse = document.getElementById('confirmAdresse');const confirmCodePostal = document.getElementById('confirmCodePostal');const confirmVille = document.getElementById('confirmVille');const confirmPays = document.getElementById('confirmPays');const confirmService = document.getElementById('confirmService');const confirmDate = document.getElementById('confirmDate');const confirmHeure = document.getElementById('confirmHeure');const confirmMotif = document.getElementById('confirmMotif');const confirmMessage = document.getElementById('confirmMessage');if(confirmNom && nomEl)confirmNom.textContent = nomEl.value;if(confirmTelephone && telephoneEl)confirmTelephone.textContent = telephoneEl.value;if(confirmEmail && emailEl)confirmEmail.textContent = emailEl.value;if(confirmDateNaissance && dateNaissanceEl && dateNaissanceEl.value){const dateNaissance = new Date(dateNaissanceEl.value);confirmDateNaissance.querySelector('span').textContent = dateNaissance.toLocaleDateString('fr-FR');confirmDateNaissance.classList.remove('d-none');}if(confirmGenre && genreEl && genreEl.value && genreEl.value !== 'non_specifie'){confirmGenre.querySelector('span').textContent = genreLabels[genreEl.value] || genreEl.value;confirmGenre.classList.remove('d-none');}if(confirmNationalite && nationaliteEl && nationaliteEl.value){confirmNationalite.querySelector('span').textContent = nationaliteEl.value;confirmNationalite.classList.remove('d-none');}if(confirmProfession && professionEl && professionEl.value){confirmProfession.querySelector('span').textContent = professionEl.value;confirmProfession.classList.remove('d-none');}if(confirmAssurance && assuranceEl && assuranceEl.value){confirmAssurance.querySelector('span').textContent = assuranceEl.value;confirmAssurance.classList.remove('d-none');}if(confirmAdresse && adresseEl)confirmAdresse.textContent = adresseEl.value;if(confirmVille && villeEl)confirmVille.textContent = villeEl.value;if(confirmPays && paysEl)confirmPays.textContent = paysEl.value;if(confirmCodePostal && codePostalEl && codePostalEl.value){confirmCodePostal.querySelector('span').textContent = codePostalEl.value;confirmCodePostal.classList.remove('d-none');}if(confirmService && serviceEl){confirmService.textContent = serviceLabels[serviceEl.value] || serviceEl.value;}if(confirmDate && dateEl && dateEl.value){const dateObj = new Date(dateEl.value);confirmDate.textContent = dateObj.toLocaleDateString('fr-FR',{weekday: 'long',year: 'numeric',month: 'long',day: 'numeric'});}if(confirmHeure && heureEl){confirmHeure.textContent = heureEl.value;}if(confirmMotif && motifEl && motifEl.value){confirmMotif.querySelector('span').textContent = motifEl.value;confirmMotif.classList.remove('d-none');}if(confirmMessage && messageEl && messageEl.value){confirmMessage.querySelector('span').textContent = messageEl.value;confirmMessage.classList.remove('d-none');}}function validateEmail(email){return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);}function validatePhone(phone){return /^[\d\s\+\-\(\)]{8,20}$/.test(phone);}function validateDate(date){const selectedDate = new Date(date);const today = new Date();today.setHours(0,0,0,0);return selectedDate >= today;}function validateTime(time){const [hours] = time.split(':').map(Number);return hours >= 8 && hours <= 19;}const appointmentForm = document.getElementById('appointmentForm');if(appointmentForm){appointmentForm.addEventListener('submit',function(e){if(!validateStep(3)){e.preventDefault();return false;}const submitBtn = document.getElementById('submitBtn');const submitText = document.getElementById('submitText');const submitSpinner = document.getElementById('submitSpinner');if(submitBtn)submitBtn.disabled = true;if(submitText)submitText.innerHTML = 'Envoi en cours...';if(submitSpinner){submitSpinner.classList.remove('d-none');submitSpinner.classList.add('d-inline-block');}});}const urlParams = new URLSearchParams(window.location.search);const status = urlParams.get('status');const message = urlParams.get('message');if(status && message){const formMessage = document.getElementById('formMessage');const formMessageText = document.getElementById('formMessageText');if(formMessage && formMessageText){formMessage.className = 'alert alert-dismissible fade show';formMessage.className += status === 'success' ? ' alert-success' : ' alert-danger';formMessageText.textContent = decodeURIComponent(message);formMessage.classList.remove('d-none');formMessage.scrollIntoView({behavior: 'smooth',block: 'center'});window.history.replaceState({},document.title,window.location.pathname);}}})();